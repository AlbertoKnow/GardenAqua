{% load static %}
{# Card de producto reutilizable - Dise√±o minimalista #}

<div class="card producto-card h-100 position-relative">
    {# Badges #}
    {% if producto.destacado %}
    <span class="badge-destacado">Destacado</span>
    {% endif %}
    
    {# Imagen #}
    <a href="{% url 'catalogo:producto_detalle' producto.slug %}">
        {% if producto.imagen_principal_url %}
        <img src="{{ producto.imagen_principal_url }}" class="card-img-top" alt="{{ producto.nombre }}">
        {% else %}
        <div class="img-placeholder">
            <i class="bi bi-image"></i>
        </div>
        {% endif %}
    </a>
    
    <div class="card-body d-flex flex-column">
        {# Marca #}
        {% if producto.marca %}
        <p class="marca mb-1">{{ producto.marca.nombre }}</p>
        {% endif %}
        
        {# Nombre #}
        <h5 class="card-title">
            <a href="{% url 'catalogo:producto_detalle' producto.slug %}">
                {{ producto.nombre }}
            </a>
        </h5>
        
        {# Precio #}
        <div class="mt-auto pt-2">
            {% with primera_presentacion=producto.presentaciones.first %}
            {% if primera_presentacion %}
                {% if producto.presentaciones.count > 1 %}
                <p class="precio-desde mb-0">Desde</p>
                {% endif %}
                
                {% if primera_presentacion.precio_oferta %}
                <p class="precio mb-1">
                    ${{ primera_presentacion.precio_oferta }}
                    <span class="precio-original ms-1">${{ primera_presentacion.precio }}</span>
                </p>
                {% else %}
                <p class="precio mb-1">${{ producto.precio_desde }}</p>
                {% endif %}
                
                {# Stock #}
                {% if producto.tiene_stock %}
                <small class="stock-disponible">Disponible</small>
                {% else %}
                <small class="stock-agotado">Agotado</small>
                {% endif %}
            {% else %}
                <p class="text-muted small">Sin presentaciones</p>
            {% endif %}
            {% endwith %}
        </div>
    </div>
</div>
